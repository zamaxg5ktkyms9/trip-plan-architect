/**
 * 楽天トラベルレンタカー用の都道府県コードマッピング
 * キー: 地名キーワード（都道府県名・主要観光地）
 * 値: 楽天トラベルレンタカーの f_cd（都道府県コード、JISコード準拠）
 */
export const RENTAL_CAR_PREF_CODES: Record<string, string> = {
  // ===== 47都道府県 =====
  // 北海道・東北
  北海道: '01',
  青森: '02',
  青森県: '02',
  岩手: '03',
  岩手県: '03',
  宮城: '04',
  宮城県: '04',
  秋田: '05',
  秋田県: '05',
  山形: '06',
  山形県: '06',
  福島: '07',
  福島県: '07',

  // 関東
  茨城: '08',
  茨城県: '08',
  栃木: '09',
  栃木県: '09',
  群馬: '10',
  群馬県: '10',
  埼玉: '11',
  埼玉県: '11',
  千葉: '12',
  千葉県: '12',
  東京: '13',
  東京都: '13',
  神奈川: '14',
  神奈川県: '14',

  // 中部
  新潟: '15',
  新潟県: '15',
  富山: '16',
  富山県: '16',
  石川: '17',
  石川県: '17',
  福井: '18',
  福井県: '18',
  山梨: '19',
  山梨県: '19',
  長野: '20',
  長野県: '20',
  岐阜: '21',
  岐阜県: '21',
  静岡: '22',
  静岡県: '22',
  愛知: '23',
  愛知県: '23',

  // 近畿
  三重: '24',
  三重県: '24',
  滋賀: '25',
  滋賀県: '25',
  京都: '26',
  京都府: '26',
  大阪: '27',
  大阪府: '27',
  兵庫: '28',
  兵庫県: '28',
  奈良: '29',
  奈良県: '29',
  和歌山: '30',
  和歌山県: '30',

  // 中国
  鳥取: '31',
  鳥取県: '31',
  島根: '32',
  島根県: '32',
  岡山: '33',
  岡山県: '33',
  広島: '34',
  広島県: '34',
  山口: '35',
  山口県: '35',

  // 四国
  徳島: '36',
  徳島県: '36',
  香川: '37',
  香川県: '37',
  愛媛: '38',
  愛媛県: '38',
  高知: '39',
  高知県: '39',

  // 九州・沖縄
  福岡: '40',
  福岡県: '40',
  佐賀: '41',
  佐賀県: '41',
  長崎: '42',
  長崎県: '42',
  熊本: '43',
  熊本県: '43',
  大分: '44',
  大分県: '44',
  宮崎: '45',
  宮崎県: '45',
  鹿児島: '46',
  鹿児島県: '46',
  沖縄: '47',
  沖縄県: '47',

  // ===== 主要観光地・都市 =====
  // 北海道
  札幌: '01',
  函館: '01',
  小樽: '01',
  旭川: '01',
  富良野: '01',
  美瑛: '01',
  ニセコ: '01',
  帯広: '01',
  釧路: '01',
  知床: '01',
  洞爺湖: '01',
  登別: '01',
  トマム: '01',

  // 東北
  仙台: '04',
  松島: '04',
  蔵王: '06',
  銀山温泉: '06',
  盛岡: '03',
  平泉: '03',
  角館: '05',
  田沢湖: '05',
  会津若松: '07',
  猪苗代: '07',
  十和田: '02',
  弘前: '02',
  奥入瀬: '02',

  // 関東
  横浜: '14',
  鎌倉: '14',
  箱根: '14',
  湘南: '14',
  江ノ島: '14',
  川崎: '14',
  浅草: '13',
  渋谷: '13',
  新宿: '13',
  池袋: '13',
  お台場: '13',
  成田: '12',
  舞浜: '12',
  房総: '12',
  銚子: '12',
  鴨川: '12',
  川越: '11',
  秩父: '11',
  草津: '10',
  伊香保: '10',
  日光: '09',
  那須: '09',
  鬼怒川: '09',
  つくば: '08',
  水戸: '08',
  大洗: '08',

  // 中部
  名古屋: '23',
  熱海: '22',
  伊豆: '22',
  下田: '22',
  浜松: '22',
  富士: '22',
  河口湖: '19',
  富士五湖: '19',
  清里: '19',
  甲府: '19',
  軽井沢: '20',
  上高地: '20',
  松本: '20',
  白馬: '20',
  諏訪: '20',
  飛騨高山: '21',
  高山: '21',
  白川郷: '21',
  下呂: '21',
  金沢: '17',
  能登: '17',
  和倉温泉: '17',
  加賀: '17',
  立山: '16',
  黒部: '16',
  越前: '18',
  永平寺: '18',
  佐渡: '15',
  越後湯沢: '15',

  // 近畿
  嵐山: '26',
  祇園: '26',
  宇治: '26',
  天橋立: '26',
  舞鶴: '26',
  梅田: '27',
  難波: '27',
  心斎橋: '27',
  USJ: '27',
  ユニバ: '27',
  神戸: '28',
  有馬温泉: '28',
  城崎温泉: '28',
  姫路: '28',
  淡路島: '28',
  南紀白浜: '30',
  白浜: '30',
  熊野: '30',
  高野山: '30',
  那智: '30',
  伊勢: '24',
  志摩: '24',
  鳥羽: '24',
  琵琶湖: '25',

  // 中国
  出雲: '32',
  松江: '32',
  玉造温泉: '32',
  倉敷: '33',
  尾道: '34',
  宮島: '34',
  呉: '34',
  しまなみ海道: '34',
  萩: '35',
  下関: '35',
  角島: '35',
  皆生温泉: '31',
  大山: '31',
  境港: '31',

  // 四国
  高松: '37',
  直島: '37',
  小豆島: '37',
  金刀比羅: '37',
  道後温泉: '38',
  松山: '38',
  しまなみ: '38',
  今治: '38',
  四万十: '39',
  桂浜: '39',
  祖谷: '36',
  鳴門: '36',

  // 九州
  博多: '40',
  太宰府: '40',
  北九州: '40',
  門司港: '40',
  糸島: '40',
  長崎市: '42',
  ハウステンボス: '42',
  佐世保: '42',
  五島: '42',
  軍艦島: '42',
  阿蘇: '43',
  天草: '43',
  黒川温泉: '43',
  熊本市: '43',
  別府: '44',
  由布院: '44',
  湯布院: '44',
  日田: '44',
  高千穂: '45',
  青島: '45',
  日南: '45',
  指宿: '46',
  屋久島: '46',
  霧島: '46',
  桜島: '46',
  種子島: '46',
  奄美: '46',
  嬉野: '41',
  唐津: '41',
  呼子: '41',
  武雄: '41',

  // 沖縄
  那覇: '47',
  石垣: '47',
  石垣島: '47',
  宮古島: '47',
  宮古: '47',
  恩納村: '47',
  美ら海: '47',
  国際通り: '47',
  北谷: '47',
  読谷: '47',
  名護: '47',
  久米島: '47',
  西表島: '47',
  竹富島: '47',
  与那国: '47',
}

/**
 * 県コードから表示用県名への変換マッピング
 * Key: 楽天トラベルの県コード（JISコード準拠）
 * Value: 表示用県名
 */
export const RAKUTEN_PREF_NAMES: Record<string, string> = {
  '01': '北海道',
  '02': '青森県',
  '03': '岩手県',
  '04': '宮城県',
  '05': '秋田県',
  '06': '山形県',
  '07': '福島県',
  '08': '茨城県',
  '09': '栃木県',
  '10': '群馬県',
  '11': '埼玉県',
  '12': '千葉県',
  '13': '東京都',
  '14': '神奈川県',
  '15': '新潟県',
  '16': '富山県',
  '17': '石川県',
  '18': '福井県',
  '19': '山梨県',
  '20': '長野県',
  '21': '岐阜県',
  '22': '静岡県',
  '23': '愛知県',
  '24': '三重県',
  '25': '滋賀県',
  '26': '京都府',
  '27': '大阪府',
  '28': '兵庫県',
  '29': '奈良県',
  '30': '和歌山県',
  '31': '鳥取県',
  '32': '島根県',
  '33': '岡山県',
  '34': '広島県',
  '35': '山口県',
  '36': '徳島県',
  '37': '香川県',
  '38': '愛媛県',
  '39': '高知県',
  '40': '福岡県',
  '41': '佐賀県',
  '42': '長崎県',
  '43': '熊本県',
  '44': '大分県',
  '45': '宮崎県',
  '46': '鹿児島県',
  '47': '沖縄県',
}

/**
 * テキストから都道府県コードを検索する
 * @param text 検索対象テキスト（タイトル、目的地など）
 * @returns [マッチした地名, 都道府県コード] または null
 */
export function findPrefectureCode(text: string): [string, string] | null {
  // 長いキーワードから優先的にマッチさせる（「神奈川県」→「神奈川」の順）
  const sortedKeys = Object.keys(RENTAL_CAR_PREF_CODES).sort(
    (a, b) => b.length - a.length
  )

  for (const keyword of sortedKeys) {
    if (text.includes(keyword)) {
      return [keyword, RENTAL_CAR_PREF_CODES[keyword]]
    }
  }

  return null
}

/**
 * 楽天トラベルレンタカーのURLを生成する
 * @param prefCode 都道府県コード（null の場合はトップページ）
 * @returns 楽天トラベルレンタカーURL
 */
export function generateRentalCarUrl(prefCode: string | null): string {
  if (prefCode) {
    return `https://cars.travel.rakuten.co.jp/cars/rcf020a.do?f_cd=${prefCode}`
  }
  return 'https://cars.travel.rakuten.co.jp/cars/'
}
